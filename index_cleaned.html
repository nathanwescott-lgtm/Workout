<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Holiday Coach</title>
<meta name="theme-color" content="#002FA7" />
<style>
  /* ===== Nike-ish clean dark theme ===== */
  :root{
    --primary:#002FA7;   /* Yves Klein Blue */
    --accent:#7BB661;    /* Brat Green */
    --bg:#0A0F14;
    --card:#111824;
    --ink:#E9EEF6;
    --muted:#9EB1C9;
    --border:#1C2432;
    --chip:#0F1621;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family: Inter, ui-sans-serif, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
  }
  header{
    position:sticky; top:0; z-index:5;
    background:linear-gradient(180deg, rgba(10,15,20,.98), rgba(10,15,20,.85), rgba(10,15,20,0));
    border-bottom:1px solid var(--border);
  }
  .wrap{max-width:980px;margin:0 auto;padding:14px 16px}
  .brand{display:flex;align-items:center;gap:10px}
  .brand .logo{width:28px;height:28px;border-radius:7px;background:conic-gradient(from 150deg, var(--primary), var(--accent)); display:grid;place-items:center}
  .brand .logo svg{width:16px;height:16px}
  h1{margin:0;font-size:1.2rem}
  .sub{color:var(--muted);font-size:.95rem;margin-top:2px}
  .countdown{background:var(--accent); color:#061309; border:1px solid #5ca24f;
             padding:8px 12px; border-radius:10px; font-weight:800; display:inline-block; margin-top:8px}
  .tabs{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
  .tab{padding:8px 12px;border:1px solid var(--border);background:var(--chip);border-radius:10px;cursor:pointer}
  .tab.active{background:var(--primary);color:#03101E;font-weight:800;border-color:transparent}

  main .card{background:var(--card); border:1px solid var(--border);
             border-radius:16px; padding:16px; margin:12px 0}
  .row{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
  .pill{padding:6px 10px;border:1px solid var(--border);border-radius:999px;background:var(--chip);color:var(--muted);font-weight:600}
  .btn{background:var(--accent);color:#09140a;font-weight:800;border:none;padding:10px 14px;border-radius:12px;cursor:pointer}
  .btn.alt{background:var(--primary);color:#fff}
  .btn.ghost{background:transparent;border:1px dashed var(--border);color:var(--muted)}
  input,select{background:#0B1220;color:var(--ink);border:1px solid var(--border);border-radius:10px;padding:10px}
  .muted{color:var(--muted)}

  .list-card{border:1px solid var(--border);border-radius:14px;padding:12px;background:#0f1722;margin:10px 0}
  .work-item{display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap}
  .work-buttons{display:flex;gap:8px}

  .progress{height:10px;background:#0e1420;border:1px solid var(--border);border-radius:999px;overflow:hidden}
  .progress>span{display:block;height:100%;background:var(--accent);width:0%}

  .diag{margin-top:10px; border:1px solid var(--border); background:#0f1722; padding:10px; border-radius:10px; color:var(--muted); font-size:.95rem}
  .diag.ok{border-color:#2e7d32; color:#b7f9c1}
  .diag.bad{border-color:#a94442; color:#ffc1c1}

  /* Bottom nav for small screens */
  .nav{position:sticky;bottom:0;z-index:4;background:var(--bg);padding:8px 0}
  .nav-inner{border:1px solid var(--border);border-radius:14px;background:var(--card);display:flex;gap:8px;padding:8px}
  .nav button{flex:1;background:var(--chip);border:1px solid var(--border);color:var(--ink);border-radius:10px;padding:10px;font-weight:700}
  .nav button.active{background:var(--primary);color:#03101E;border-color:transparent}

  @media(min-width:900px){ .nav{display:none} }
</style>
</head>
<body>
<header>
  <div class="wrap">
    <div class="brand">
      <div class="logo" aria-hidden="true">
        <!-- dumbbell+palm tree glyph -->
        <svg viewBox="0 0 24 24" fill="currentColor">
          <path d="M4 10h2v4H4v-4Zm14 0h2v4h-2v-4ZM7 8h2v8H7V8Zm8 0h2v8h-2V8ZM10 9h4v6h-4V9Z"/>
        </svg>
      </div>
      <div>
        <h1>Holiday Coach</h1>
        <div class="sub">Yves Klein Blue + Brat Green Â· Spin Mon/Wed/Sat Â· Beer is free</div>
      </div>
    </div>
    <div class="row">
      <div id="countdown" class="countdown">Loadingâ€¦</div>
    </div>
    <div class="tabs" id="tabs">
      <div class="tab active" data-tab="home">Home</div>
      <div class="tab" data-tab="workouts">Workouts</div>
      <div class="tab" data-tab="nutrition">Meals</div>
      <div class="tab" data-tab="tracking">Tracking</div>
    </div>
  </div>
</header>

<main class="wrap">
  <!-- HOME -->
  <section class="card" id="tab-home">
    <div class="row">
      <span class="pill" id="phasePill">Phase</span>
      <span class="pill" id="kcalPill">Kcal</span>
      <span class="pill" id="todayTypePill">Today</span>
    </div>
    <h2>Welcome back</h2>
    <p class="muted">Letâ€™s crush your goals today.</p>
    <div id="diag" class="diag">Diagnostics: runningâ€¦</div>
    <div class="row" style="margin-top:10px">
      <div class="card" style="flex:1;min-width:260px">
        <h3>Today's Workout</h3>
        <div id="today-workout"></div>
        <div class="row" style="margin-top:8px">
          <button class="btn alt" onclick="showTab('workouts')">Open Workouts</button>
        </div>
      </div>
      <div class="card" style="flex:1;min-width:260px">
        <h3>Today's Meals</h3>
        <div id="today-meals"></div>
        <div class="row" style="margin-top:8px">
          <button class="btn" onclick="showTab('nutrition')">Open Meals</button>
        </div>
      </div>
    </div>
  </section>

  <!-- WORKOUTS -->
  <section class="card" id="tab-workouts" style="display:none">
    <h2>Workouts</h2>
    <p class="muted">Pick a session and start guided mode with builtâ€‘in rest timers.</p>
    <div class="row" style="margin:6px 0">
      <label class="pill">Today:
        <select id="todayType">
          <option>Spin</option><option>Push</option><option>Pull</option><option>Legs</option><option>Upper</option><option>Full Body</option><option>Rest</option>
        </select>
      </label>
    </div>
    <div id="workout-list"></div>
  </section>

  <!-- NUTRITION -->
  <section class="card" id="tab-nutrition" style="display:none">
    <h2>Meals & Snacks</h2>
    <div id="meal-plan"></div>
  </section>

  <!-- TRACKING -->
  <section class="card" id="tab-tracking" style="display:none">
    <h2>Tracking</h2>
    <div class="row">
      <label class="pill">Current Weight (kg): <input type="number" id="weight-input" value="75" step="0.1" style="width:120px"></label>
      <button class="btn" id="save-weight">Save</button>
    </div>
    <div class="card" style="margin-top:10px">
      <div class="row"><span>7â€‘day trend</span><div class="progress" style="flex:1"><span id="trendBar"></span></div></div>
      <div class="muted" id="trendText" style="margin-top:6px">â€”</div>
    </div>
    <div id="weight-history" class="list-card"></div>
  </section>

  <div class="nav">
    <div class="nav-inner">
      <button id="nav-home" class="active" onclick="showTab('home')">Home</button>
      <button id="nav-workouts" onclick="showTab('workouts')">Workouts</button>
      <button id="nav-nutrition" onclick="showTab('nutrition')">Meals</button>
      <button id="nav-tracking" onclick="showTab('tracking')">Tracking</button>
    </div>
  </div>
</main>

<script>
/* ===== Utilities ===== */
const $ = (id)=>document.getElementById(id);
function setActive(tab){
  document.querySelectorAll('.tab').forEach(t=>t.classList.toggle('active', t.dataset.tab===tab));
  ['home','workouts','nutrition','tracking'].forEach(x=>{
    $('tab-'+x).style.display = (x===tab)?'block':'none';
    const n = $('nav-'+x); if(n) n.classList.toggle('active', x===tab);
  });
}
function showTab(tab){ setActive(tab); location.hash = tab; }

/* ===== Countdown ===== */
function updateCountdown(){
  const target = new Date("2025-10-25T00:00:00Z").getTime();
  const now = Date.now(), d = target - now;
  if(d<0){ $('countdown').textContent="Holiday time! ðŸ"; return; }
  const days = Math.floor(d/86400000);
  $('countdown').textContent = days + " days until holiday â€” stay on track!";
}
updateCountdown(); setInterval(updateCountdown, 3600000);

/* ===== Phase & kcal ===== */
function currentPhase(){
  const cut = new Date("2025-09-15T00:00:00Z");
  return new Date() < cut ? "Bulk" : "Cut";
}
function currentKcal(){ return currentPhase()==="Bulk" ? 2950 : 2550; }
$('phasePill').textContent = currentPhase();
$('kcalPill').textContent  = currentKcal()+" kcal";

/* ===== Default schedule (Mon/Wed/Sat Spin) ===== */
function defaultTypeFor(d){
  const idx = (d.getDay()+6)%7; // Mon=0
  return ["Spin","Push","Spin","Pull","Legs","Spin","Upper"][idx];
}
const today = new Date();
const todayType = defaultTypeFor(today);
$('todayTypePill').textContent = todayType;

/* ===== Workouts data ===== */
const workouts = [
  { name:"Push",  exercises:["Incline Bench Press","Overhead Press","Dumbbell Lateral Raise","Skull Crushers"] },
  { name:"Pull",  exercises:["Barbell Row","Oneâ€‘Arm DB Row","Hammer Curl","Rear Delt Fly"] },
  { name:"Legs",  exercises:["Back Squat","Romanian Deadlift","Bulgarian Split Squat","Calf Raise"] },
  { name:"Upper", exercises:["Incline Bench Press","Barbell Row","Overhead Press","Incline DB Press","Hammer Curl"] },
  { name:"Full Body", exercises:["Back Squat","Incline Bench Press","Barbell Row","Overhead Press"] },
  { name:"Spin", exercises:["45â€“60 min spin (moderateâ€‘hard)"] }
];

/* ===== Render workout list with Start / Preview ===== */
function renderWorkouts(){
  const html = workouts.map((w,i)=>`
    <div class="list-card">
      <div class="work-item">
        <div>
          <div style="font-weight:800;color:var(--accent)">${w.name}</div>
          <div class="muted" style="max-width:640px">${w.exercises.join(" Â· ")}</div>
        </div>
        <div class="work-buttons">
          <button class="btn" onclick="startWorkout(${i})">Start</button>
          <button class="btn alt" onclick="previewWorkout(${i})">Preview</button>
        </div>
      </div>
    </div>
  `).join("");
  $('workout-list').innerHTML = html;
}
function previewWorkout(i){
  const w = workouts[i];
  alert(`${w.name}\n\n${w.exercises.map((e,idx)=>`${idx+1}. ${e}`).join("\n")}`);
}
let restTimers = {};
function fmt(secs){ const m=Math.floor(secs/60), s=secs%60; return `${String(m).padStart(2,"0")}:${String(s).padStart(2,"0")}`; }
function startWorkout(i){
  const w = workouts[i];
  const baseRest = (w.name==="Legs"||w.name==="Full Body")?90:60;
  $('workout-list').innerHTML = `
    <div class="list-card">
      <div style="font-weight:800;color:var(--accent);font-size:1.05rem">${w.name} â€” Guided</div>
      ${w.exercises.map((e,ix)=>`
        <div style="margin:10px 0;padding:10px;border:1px solid var(--border);border-radius:12px;background:#0b1220">
          <strong>${ix+1}. ${e}</strong>
          <div class="row" style="margin-top:6px">
            <label>Weight (kg): <input type="number" step="0.5" id="w_${ix}" style="width:100px"></label>
            <label>Reps: <input type="number" step="1" id="r_${ix}" style="width:80px"></label>
          </div>
          <div class="row" style="margin-top:6px">
            <button class="btn alt" onclick="rest(${ix},${baseRest})">Rest ${baseRest}s</button>
            <span id="t_${ix}" class="muted">Ready</span>
          </div>
        </div>
      `).join("")}
      <button class="btn" onclick="finishWorkout('${w.name}')">Finish Session</button>
    </div>
  `;
}
function rest(ix,secs){
  const el = $('t_'+ix);
  clearInterval(restTimers[ix]); let s=secs; el.textContent = "Rest "+fmt(s);
  restTimers[ix] = setInterval(()=>{ s--; el.textContent = s>0?("Rest "+fmt(s)):"Go!"; if(s<=0) clearInterval(restTimers[ix]); }, 1000);
}
function finishWorkout(name){
  alert("Session saved âœ… â€” nice work on "+name+"!");
  renderWorkouts();
}

/* ===== Meals data & render ===== */
const meals = {
  breakfast:[
    "150g Greek yogurt","50g oats","60g vegan protein (Bulk Powders)",
    "6g creatine","100g cherry juice","100g berries","25g peanut butter"
  ],
  lunch:[ "Chickenâ€“riceâ€“veg base (portions scale for bulk/cut)" ],
  snack:[ "150g Greek yogurt","100g berries","30g peanuts","50g smooth peanut butter","15g honey" ],
  dinner:[ "Chickenâ€“riceâ€“veg base variation" ]
};
function renderMeals(){
  $('today-meals').innerHTML =
    "<ul>"
    + meals.breakfast.map(m=>`<li>${m}</li>`).join("")
    + meals.lunch.map(m=>`<li>${m}</li>`).join("")
    + meals.snack.map(m=>`<li>${m}</li>`).join("")
    + meals.dinner.map(m=>`<li>${m}</li>`).join("")
    + "</ul>";
  $('meal-plan').innerHTML =
    "<h3>Breakfast</h3><ul>"+meals.breakfast.map(m=>`<li>${m}</li>`).join("")+"</ul>"
  + "<h3>Lunch</h3><ul>"+meals.lunch.map(m=>`<li>${m}</li>`).join("")+"</ul>"
  + "<h3>Snack</h3><ul>"+meals.snack.map(m=>`<li>${m}</li>`).join("")+"</ul>"
  + "<h3>Dinner</h3><ul>"+meals.dinner.map(m=>`<li>${m}</li>`).join("")+"</ul>";
}

/* ===== Today's workout preview on Home ===== */
function renderToday(){
  const w = workouts.find(x=>x.name===todayType) || workouts[0];
  $('today-workout').innerHTML = "<ul>"+w.exercises.map(e=>`<li>${e}</li>`).join("")+"</ul>";
  $('todayType').value = w.name || todayType;
}

/* ===== Weight tracking + trend (simple) ===== */
let weightHistory = JSON.parse(localStorage.getItem("weightHistory")||"[]");
function saveWeight(){
  const v = parseFloat($('weight-input').value);
  if(!isNaN(v)){ weightHistory.push({d:new Date().toISOString().slice(0,10), w:v});
    localStorage.setItem("weightHistory", JSON.stringify(weightHistory));
    renderWeightHistory();
  }
}
$('save-weight').addEventListener('click', saveWeight);
function renderWeightHistory(){
  const list = weightHistory.slice(-14).map(x=>`<li>${x.d}: ${x.w} kg</li>`).join("");
  $('weight-history').innerHTML = "<h3>Recent</h3><ul>"+list+"</ul>";
  // trend (last 7 entries)
  if(weightHistory.length>=2){
    const last7 = weightHistory.slice(-7);
    const first=last7[0], last=last7[last7.length-1];
    const days = Math.max(1, (new Date(last.d)-new Date(first.d))/86400000);
    const rate = (last.w-first.w)/days*7; // kg/wk
    $('trendText').textContent = (rate>0?"+":"")+rate.toFixed(2)+" kg/wk";
    $('trendBar').style.width = Math.min(100, Math.abs(rate)*100/1.0) + "%";
  }
}

/* ===== Simple router: supports #tab and /Workout/ ===== */
(function router(){
  const hash = (location.hash||"").replace("#","");
  const lastSeg = location.pathname.split("/").filter(Boolean).pop() || "";
  let target = hash || lastSeg.toLowerCase() || "home";
  if(!["home","workouts","nutrition","tracking"].includes(target)) target="home";
  showTab(target);
})();

/* ===== Render all ===== */
renderWorkouts();
renderMeals();
renderToday();
renderWeightHistory();

/* ===== Diagnostics (self-test) ===== */
(function selfTest(){
  const checks = [];
  const ok = (c)=>checks.push("âœ… "+c);
  const bad = (c)=>checks.push("âŒ "+c);

  // elements
  $('workout-list') ? ok("Workouts container exists") : bad("Workouts container missing");
  $('today-workout') ? ok("Today's workout renders") : bad("Today's workout missing");
  $('meal-plan') ? ok("Meals plan container exists") : bad("Meals plan missing");
  // data renders
  if(($('workout-list').innerHTML||"").length>30) ok("Workout options rendered");
  else bad("Workout options failed to render");
  if(($('today-meals').innerHTML||"").length>30) ok("Today meals rendered");
  else bad("Today meals failed to render");
  // localStorage test
  try{ localStorage.setItem("_hc_test","1"); localStorage.removeItem("_hc_test"); ok("localStorage OK"); }catch(e){ bad("localStorage blocked"); }
  // display
  const good = checks.every(c=>c.startsWith("âœ…"));
  $('diag').className = "diag " + (good?"ok":"bad");
  $('diag').innerHTML = "<strong>"+(good?"All systems go":"Issues detected")+"</strong><br>"+checks.join("<br>");
})();
</script>
</body>
</html>
